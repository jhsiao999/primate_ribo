out$genes <- Biobase::fData(counts)
if (length(Biobase::pData(counts)))
out$targets <- Biobase::pData(counts)
counts <- Biobase::exprs(counts)
}
else {
counts <- as.matrix(counts)
}
}
if (is.null(design)) {
design <- matrix(1, ncol(counts), 1)
rownames(design) <- colnames(counts)
colnames(design) <- "GrandMean"
}
if (is.null(lib.size))
lib.size <- colSums(counts)
y <- t(log2(t(counts + 0.5)/(lib.size + 1) * 1e+06))
y <- normalizeBetweenArrays(y, method = normalize.method)
fit <- lmFit(y, design, ...)
if (is.null(fit$Amean))
fit$Amean <- rowMeans(y, na.rm = TRUE)
sx <- fit$Amean + mean(log2(lib.size + 1)) - log2(1e+06)
sy <- sqrt(fit$sigma)
allzero <- rowSums(counts) == 0
if (any(allzero)) {
sx <- sx[!allzero]
sy <- sy[!allzero]
}
l <- lowess(sx, sy, f = span)
if (plot) {
plot(sx, sy, xlab = "log2( count size + 0.5 )", ylab = "Sqrt( standard deviation )",
pch = 16, cex = 0.25)
title("voom: Mean-variance trend")
lines(l, col = "red")
}
f <- approxfun(l, rule = 2)
if (fit$rank < ncol(design)) {
j <- fit$pivot[1:fit$rank]
fitted.values <- fit$coef[, j, drop = FALSE] %*% t(fit$design[,
j, drop = FALSE])
}
else {
fitted.values <- fit$coef %*% t(fit$design)
}
fitted.cpm <- 2^fitted.values
fitted.count <- 1e-06 * t(t(fitted.cpm) * (lib.size + 1))
fitted.logcount <- log2(fitted.count)
w <- 1/f(fitted.logcount)^4
dim(w) <- dim(fitted.logcount)
out$E <- y
out$weights <- w
out$design <- design
if (is.null(out$targets))
out$targets <- data.frame(lib.size = lib.size)
else out$targets$lib.size <- lib.size
new("EList", out)
}
voom_NA <- function (counts, design = NULL, lib.size = NULL, normalize.method = "none",
plot = FALSE, span = 0.5, ...)
{
out <- list()
if (is(counts, "DGEList")) {
out$genes <- counts$genes
out$targets <- counts$samples
if (is.null(design) && diff(range(as.numeric(counts$sample$group))) >
0)
design <- model.matrix(~group, data = counts$samples)
if (is.null(lib.size))
lib.size <- with(counts$samples, lib.size * norm.factors)
counts <- counts$counts
}
else {
isExpressionSet <- suppressPackageStartupMessages(is(counts,
"ExpressionSet"))
if (isExpressionSet) {
if (length(Biobase::fData(counts)))
out$genes <- Biobase::fData(counts)
if (length(Biobase::pData(counts)))
out$targets <- Biobase::pData(counts)
counts <- Biobase::exprs(counts)
}
else {
counts <- as.matrix(counts)
}
}
if (is.null(design)) {
design <- matrix(1, ncol(counts), 1)
rownames(design) <- colnames(counts)
colnames(design) <- "GrandMean"
}
if (is.null(lib.size))
lib.size <- colSums(counts)
y <- t(log2(t(counts + 0.5)/(lib.size + 1) * 1e+06))
y <- normalizeBetweenArrays(y, method = normalize.method)
fit <- lmFit(y, design, ...)
if (is.null(fit$Amean))
fit$Amean <- rowMeans(y, na.rm = TRUE)
sx <- fit$Amean + mean(log2(lib.size + 1)) - log2(1e+06)
sy <- sqrt(fit$sigma)
allzero <- rowSums(counts, na.rm = TRUE) == 0
if (any(allzero)) {
sx <- sx[!allzero]
sy <- sy[!allzero]
}
l <- lowess(sx, sy, f = span)
if (plot) {
plot(sx, sy, xlab = "log2( count size + 0.5 )", ylab = "Sqrt( standard deviation )",
pch = 16, cex = 0.25)
title("voom: Mean-variance trend")
lines(l, col = "red")
}
f <- approxfun(l, rule = 2)
if (fit$rank < ncol(design)) {
j <- fit$pivot[1:fit$rank]
fitted.values <- fit$coef[, j, drop = FALSE] %*% t(fit$design[,
j, drop = FALSE])
}
else {
fitted.values <- fit$coef %*% t(fit$design)
}
fitted.cpm <- 2^fitted.values
fitted.count <- 1e-06 * t(t(fitted.cpm) * (lib.size + 1))
fitted.logcount <- log2(fitted.count)
w <- 1/f(fitted.logcount)^4
dim(w) <- dim(fitted.logcount)
out$E <- y
out$weights <- w
out$design <- design
if (is.null(out$targets))
out$targets <- data.frame(lib.size = lib.size)
else out$targets$lib.size <- lib.size
new("EList", out)
}
voom_NA(counts = exprs(eSet_sub),
lib.size = colSums(exprs(eSet_sub), na.rm = TRUE),
design = model.matrix( ~ as.factor(seqData)*as.factor(species), data = pData(eSet_sub)) )
voom_fit <- voom_NA(counts = exprs(eSet_sub),
lib.size = colSums(exprs(eSet_sub), na.rm = TRUE),
design = model.matrix( ~ as.factor(seqData)*as.factor(species), data = pData(eSet_sub)) )
names(voom_fit)
head(voom_fit$weights)
install_github("jhsiao999/Humanzee")
require(Humanzee)
voom_fit <-
Humanzee::voom_NA(counts = exprs(eSet_sub),
lib.size = colSums(exprs(eSet_sub), na.rm = TRUE),
design = model.matrix( ~ as.factor(seqData)*as.factor(species),
data = pData(eSet_sub)) ,
normalize.method = "quantile")
install_github("jhsiao999/Humanzee")
require(Humanzee)
voom_fit <-
Humanzee::voom_NA(counts = exprs(eSet_sub),
lib.size = colSums(exprs(eSet_sub), na.rm = TRUE),
design = model.matrix( ~ as.factor(seqData)*as.factor(species),
data = pData(eSet_sub)) ,
normalize.method = "quantile")
names(voom_fit)
?lmFit
load(file.path(rdadir, "eSetRRP.rda"))
eSet_human_chimp <- eSetRRP.RP.Q.log2[ ,
eSetRRP.RP.Q.log2$seqData != "protein" & eSetRRP.RP.Q.log2$species != "rhesus"]
lm
head(voom_fit$weights)
interact2way_coef_ww <- function (eSet, weights)
{
fNames <- featureNames(eSet)
require(nlme)
gls.res <- lapply(1:length(fNames), function(i) {
mat1 <- eSet[featureNames(eSet) == fNames[i], ]
mat1aov.temp <- data.frame(cov = c(t(exprs(mat1))), seqData = mat1$seqData,
species = mat1$species, celline = mat1$celline)
mat1aov.temp$species <- as.factor(mat1aov.temp$species)
mat1aov.temp$seqData <- as.factor(mat1aov.temp$seqData)
fit_interact_try <- tryCatch(fit_interact <- gls(cov ~
species * seqData, weights = weights[i, ],
data = mat1aov.temp, na.action = na.omit),
condition = function(c) c)
coef_table <- summary(fit_interact_try)$tTable
return(coef_table)
})
names(gls.res) <- fNames
return(gls.res)
}
names(voom_fit)
eSet_human_chimp <- eSetRRP.RP.Q.log2[ ,
eSetRRP.RP.Q.log2$seqData != "protein" & eSetRRP.RP.Q.log2$species != "rhesus"]
interact2way_coef_ww <- function (eSet, weights)
{
fNames <- featureNames(eSet)
require(nlme)
gls.res <- lapply(1:length(fNames), function(i) {
mat1 <- eSet[featureNames(eSet) == fNames[i], ]
mat1aov.temp <- data.frame(cov = c(t(exprs(mat1))), seqData = mat1$seqData,
species = mat1$species, celline = mat1$celline)
mat1aov.temp$species <- as.factor(mat1aov.temp$species)
mat1aov.temp$seqData <- as.factor(mat1aov.temp$seqData)
fit_interact_try <- tryCatch(fit_interact <- gls(cov ~
species * seqData, weights = weights[i, ],
data = mat1aov.temp, na.action = na.omit),
condition = function(c) c)
coef_table <- summary(fit_interact_try)$tTable
return(coef_table)
})
names(gls.res) <- fNames
return(gls.res)
}
riborna_coef_human_chimp <-
interact2way_coef_ww(eSet_human_chimp, weights = voom_fit$weights)
head(weights = voom_fit$weights)
head(voom_fit$weights)
voom_fit$weights[1,]
eSet = eSet_human_chimp
weights = voom_fit$weights
fNames <- featureNames(eSet)
require(nlme)
i = 1
mat1 <- eSet[featureNames(eSet) == fNames[i], ]
mat1aov.temp <- data.frame(cov = c(t(exprs(mat1))), seqData = mat1$seqData,
species = mat1$species, celline = mat1$celline)
mat1aov.temp$species <- as.factor(mat1aov.temp$species)
mat1aov.temp$seqData <- as.factor(mat1aov.temp$seqData)
fit_interact_try <- tryCatch(fit_interact <- gls(cov ~
species * seqData, weights = weights[i, ],
data = mat1aov.temp, na.action = na.omit),
condition = function(c) c)
fit_interact_try
lmFit
?lmFit
head(voom_fit$E)
fit <- lmFit(voom_fit$E,
design = model.matrix( ~ as.factor(seqData)*as.factor(species),
data = pData(eSet_sub)),
weights = voom_fit$weights)
names(fit)
head(fit$coef)
fit <- eBayes(fit)
?eBayes
?contrasts.fit
contrast_fit <- contrast.fit(fit, contrasts = cbind(0, 0, 0, 1))
contrast_fit <- contrasts.fit(fit, contrasts = cbind(0, 0, 0, 1))
contrast_fit <- contrasts.fit(fit, contrasts = cbind(c(0, 0, 0, 1)) )
contrast_fit
contrast_fit <- eBayes(contrast_fit)
contrast_fit
names(contrast_fit)
head(contrast_fit$p.value)
hist(contrast_fit$p.value, main = "Interaction p-value")
names(contrast_fit)
qvals <- qvalue(contrast_fit$p.value)$qvalue
sum(qvals < .01)
hist(contrast_fit$F.p.value, main = "Interaction p-value")
qvals <- qvalue(contrast_fit$F.p.value)$qvalue
sum(qvals < .01)
contrast_fit$contrast
load(file = file.path(rdadir, "riborna_coef.rda") )
pvals <- sapply(riborna_coef, function(per_gene) {
per_gene[4,4]
})
hist(pvals)
load(file = file.path(rdadir, "riborna_coef.rda") )
pvals <- sapply(riborna_coef_human_chimp, function(per_gene) {
per_gene[4,4]
})
hist(pvals)
load(file = file.path(rdadir,"riborna_coef.rda"))
betas_df <- lapply(riborna_coef_human_chimp, function(per_gene) {
data.frame(beta = per_gene[4, 1],
se = per_gene[4, 2])
})
betas_df <- do.call(rbind, betas_df)
head(betas_df)
beta.ash <- ash(betas_df[,1], betas_df[,2], df = 16)
str(beta.ash)
plot(x = betas_df[,1],
y = beta.ash$PosteriorMean,
xlab = "Regression coefficients",
ylab = "Posterior means")
abline(0, 1, col = "red")
abline(h = 0, v = 0, col = "blue")
.784+.148
.784+.148+.016
.784+.148+.0677
sum(beta.ash$lfsr < .01)
str(beta.ash)
with(beta.ash, fitted.g$b[fitted.g$pi != 0])
with(beta.ash, fitted.g$pi[fitted.g$pi != 0])
with(beta.ash, round(rfitted.g$pi[fitted.g$pi != 0]), 3)
with(beta.ash, round(fitted.g$pi[fitted.g$pi != 0]), 3)
with(beta.ash, round(fitted.g$pi[fitted.g$pi != 0], 3) )
with(beta.ash, round(fitted.g$pi[fitted.g$pi != 0], 4) )
with(beta.ash, fitted.g$b[fitted.g$pi != 0])
hist(betas_df$beta)
summary(betas_df$beta)
plot(x = betas_df[,1],
y = beta.ash$PosteriorMean,
xlab = "Regression coefficients",
ylab = "Posterior means")
abline(0, 1, col = "red")
abline(h = 0, v = 0, col = "blue")
names(beta.ash)
str(beta.ash)
hist(beta.ash$ZeroProb)
sum(beta.ash$ZeroProb < .01)
sum(beta.ash$ZeroProb < .1)
sum(beta.ash$lfsr < .1)
?gls
require(statmod)
?gls
require(nlme)
?gls
?varIdent
library(Biobase)
## Set working directories
dir <- "../"
figdir <- file.path(dir,"figures")
rdadir <- file.path(dir,"rdas")
datadir <- file.path(dir, "data")
## Use broman package for colors
require(broman)
crayon <- brocolors("crayons")
## Load customized packages
library(qvalue)
library(limma)
library(Humanzee)
load(file.path(rdadir,"eSetRRP.rda"))
load(file.path(rdadir,"datasub.rda"))
genes_sub <- fData(eSetRRP.RP.Q.log2)$ENSGID
eSet_sub <- eSetNone[ which(fData(eSetNone)$ENSGID %in% genes_sub),
eSetNone$species != "rhesus"]
voom_fit <-
Humanzee::voom_NA(counts = exprs(eSet_sub),
lib.size = colSums(exprs(eSet_sub), na.rm = TRUE),
design = model.matrix( ~ as.factor(seqData)*as.factor(species),
data = pData(eSet_sub)),
normalize.method = "quantile")
names(voom_fit)
load(file.path(rdadir, "eSetRRP.rda"))
eSet_human_chimp <- eSetRRP.RP.Q.log2[ ,
eSetRRP.RP.Q.log2$seqData != "protein" & eSetRRP.RP.Q.log2$species != "rhesus"]
fit <- lmFit(voom_fit$E,
design = model.matrix( ~ as.factor(seqData)*as.factor(species),
data = pData(eSet_sub)),
weights = voom_fit$weights)
contrast_fit <- contrasts.fit(fit, contrasts = cbind(c(0, 0, 0, 1)) )
# Empirical bayes
contrast_fit <- eBayes(contrast_fit)
# Contrast test of only the interaction effect
contrast_fit$contrast
load(file.path(rdadir, "eSetRRP.rda"))
eSet_human_chimp <- eSetRRP.RP.Q.log2[ ,
eSetRRP.RP.Q.log2$seqData != "protein" & eSetRRP.RP.Q.log2$species != "rhesus"]
interact2way_coef <- function (eSet)
{
fNames <- featureNames(eSet)
require(nlme)
gls.res <- lapply(1:length(fNames), function(i) {
mat1 <- eSet[featureNames(eSet) == fNames[i], ]
mat1aov.temp <- data.frame(cov = c(t(exprs(mat1))), seqData = mat1$seqData,
species = mat1$species, celline = mat1$celline)
mat1aov.temp$species <- as.factor(mat1aov.temp$species)
mat1aov.temp$seqData <- as.factor(mat1aov.temp$seqData)
fit_interact_try <- tryCatch(fit_interact <- gls(cov ~
species * seqData, weights = varIdent(form = ~1 |
seqData), data = mat1aov.temp, na.action = na.omit),
condition = function(c) c)
coef_table <- summary(fit_interact_try)$tTable
return(coef_table)
})
names(gls.res) <- fNames
return(gls.res)
}
names(fit)
names(voom_fit)
eSet_human_chimp <- eSetRRP.RP.Q.log2[ ,
eSetRRP.RP.Q.log2$seqData != "protein" & eSetRRP.RP.Q.log2$species != "rhesus"]
interact2way
interact2way_coef_voom <- function (eSet, weights)
{
fNames <- featureNames(eSet)
require(nlme)
gls.res <- lapply(1:length(fNames), function(i) {
mat1 <- eSet[featureNames(eSet) == fNames[i], ]
mat1aov.temp <- data.frame(cov = c(t(exprs(mat1))), seqData = mat1$seqData,
species = mat1$species, celline = mat1$celline)
mat1aov.temp$species <- as.factor(mat1aov.temp$species)
mat1aov.temp$seqData <- as.factor(mat1aov.temp$seqData)
fit_null_try <-
tryCatch(fit_null <- gls(cov ~ species + seqData,
weights = weights[i, ],
data = mat1aov.temp, na.action = na.omit),
condition = function(c) c)
if (inherits(fit_null_try, "condition")) {
res <- data.frame(LRatio = NA, LR_pval = NA)
}
else {
fit_interact_try <-
tryCatch(fit_interact <- gls(cov ~ species * seqData,
weights = weights[i, ],
data = mat1aov.temp, na.action = na.omit),
condition = function(c) c)
if (inherits(fit_interact_try, "condition")) {
res <- data.frame(LRatio = NA, LR_pval = NA)
}
else {
aov <- anova(fit_null_try, fit_interact_try)
res <- data.frame(LRatio = aov[2, "L.Ratio"],
LR_pval = aov[2, "p-value"])
}
return(res)
}
})
LR_res <- do.call(rbind, gls.res)
int.qval <- get_qval(LR_res$LR_pval)
return(data.frame(ENSGID = fNames, LRatio = LR_res$LRatio,
int.pval = LR_res$LR_pval, int.qval = int.qval))
}
eSet_human_chimp <- eSetRRP.RP.Q.log2[ ,
eSetRRP.RP.Q.log2$seqData != "protein" & eSetRRP.RP.Q.log2$species != "rhesus"]
fit_LR_voom <- interact2way_coef_voom(eSet_human_chimp,
weights = fit_voom$weights)
eSet = eSet_human_chimp; weights = fit_voom$weights
load(file.path(rdadir, "eSetRRP.rda"))
eSet_human_chimp <- eSetRRP.RP.Q.log2[ ,
eSetRRP.RP.Q.log2$seqData != "protein" & eSetRRP.RP.Q.log2$species != "rhesus"]
fit <- lmFit(voom_fit$E,
design = model.matrix( ~ as.factor(seqData)*as.factor(species),
data = pData(eSet_sub)),
weights = voom_fit$weights)
fit_LR_voom <- interact2way_coef_voom(eSet = eSet_human_chimp,
weights = fit$weights)
names(fit_LR_voom)
hist(fit_LR_voom$int.pval, main = "Interaction p-value")
qvals <- qvalue(fit_LR_voom$int.pval)$qvalue
sum(qvals < .01)
head(voom_fit$weights)
lmFit
lm.series
lm.wfit
voom
obs_weighted <- voom_fit$E*voom_fit$weights
boxplot(data.frame(human_rna = obs_weighted[ , pData(eSet_human_chimp)$species == "human" & pData(eSet_human_chimp)$seqData == "ribo"],
human_rna = obs_weighted[ , pData(eSet_human_chimp)$species == "human" & pData(eSet_human_chimp)$seqData == "rna"],
human_rna = obs_weighted[ , pData(eSet_human_chimp)$species == "chimp" & pData(eSet_human_chimp)$seqData == "ribo"],
human_rna = obs_weighted[ , pData(eSet_human_chimp)$species == "chimp" & pData(eSet_human_chimp)$seqData == "rna"]
))
require(matrixStats)
boxplot(data.frame(human_rna = rowVars(obs_weighted[ , pData(eSet_human_chimp)$species == "human" & pData(eSet_human_chimp)$seqData == "ribo"], na.rm = TRUE),
human_rna = rowVars(obs_weighted[ , pData(eSet_human_chimp)$species == "human" & pData(eSet_human_chimp)$seqData == "rna"], na.rm = TRUE),
human_rna = rowVars(obs_weighted[ , pData(eSet_human_chimp)$species == "chimp" & pData(eSet_human_chimp)$seqData == "ribo"], na.rm = TRUE),
human_rna = rowVars(obs_weighted[ , pData(eSet_human_chimp)$species == "chimp" & pData(eSet_human_chimp)$seqData == "rna"], na.rm = TRUE)
))
summary(obs_weighted)
require(matrixStats)
boxplot(data.frame(human_rna = rowVars(obs_weighted[ , pData(eSet_human_chimp)$species == "human" & pData(eSet_human_chimp)$seqData == "ribo"], na.rm = TRUE),
human_ribo = rowVars(obs_weighted[ , pData(eSet_human_chimp)$species == "human" & pData(eSet_human_chimp)$seqData == "rna"], na.rm = TRUE),
chimp_rna = rowVars(obs_weighted[ , pData(eSet_human_chimp)$species == "chimp" & pData(eSet_human_chimp)$seqData == "ribo"], na.rm = TRUE),
chimp_ribo = rowVars(obs_weighted[ , pData(eSet_human_chimp)$species == "chimp" & pData(eSet_human_chimp)$seqData == "rna"], na.rm = TRUE)
))
require(matrixStats)
boxplot(data.frame(human_rna = rowVars(obs_weighted[ , pData(eSet_human_chimp)$species == "human" & pData(eSet_human_chimp)$seqData == "ribo"], na.rm = TRUE),
human_ribo = rowVars(obs_weighted[ , pData(eSet_human_chimp)$species == "human" & pData(eSet_human_chimp)$seqData == "rna"], na.rm = TRUE),
chimp_rna = rowVars(obs_weighted[ , pData(eSet_human_chimp)$species == "chimp" & pData(eSet_human_chimp)$seqData == "ribo"], na.rm = TRUE),
chimp_ribo = rowVars(obs_weighted[ , pData(eSet_human_chimp)$species == "chimp" & pData(eSet_human_chimp)$seqData == "rna"], na.rm = TRUE)
) )
boxplot(data.frame(human_rna = rowVars(obs_weighted[ , pData(eSet_human_chimp)$species == "human" & pData(eSet_human_chimp)$seqData == "rna"], na.rm = TRUE),
human_ribo = rowVars(obs_weighted[ , pData(eSet_human_chimp)$species == "human" & pData(eSet_human_chimp)$seqData == "ribo"], na.rm = TRUE),
chimp_rna = rowVars(obs_weighted[ , pData(eSet_human_chimp)$species == "chimp" & pData(eSet_human_chimp)$seqData == "rna"], na.rm = TRUE),
chimp_ribo = rowVars(obs_weighted[ , pData(eSet_human_chimp)$species == "chimp" & pData(eSet_human_chimp)$seqData == "ribo"], na.rm = TRUE)
) )
names(voom_fit)
require(matrixStats)
boxplot(data.frame(human_rna = rowVars(voom_fit$E[ , pData(eSet_human_chimp)$species == "human" & pData(eSet_human_chimp)$seqData == "rna"], na.rm = TRUE),
human_ribo = rowVars(voom_fit$E[ , pData(eSet_human_chimp)$species == "human" & pData(eSet_human_chimp)$seqData == "ribo"], na.rm = TRUE),
chimp_rna = rowVars(voom_fit$E[ , pData(eSet_human_chimp)$species == "chimp" & pData(eSet_human_chimp)$seqData == "rna"], na.rm = TRUE),
chimp_ribo = rowVars(voom_fit$E[ , pData(eSet_human_chimp)$species == "chimp" & pData(eSet_human_chimp)$seqData == "ribo"], na.rm = TRUE)
) )
boxplot(log2(data.frame(human_rna = rowVars(voom_fit$E[ , pData(eSet_human_chimp)$species == "human" & pData(eSet_human_chimp)$seqData == "rna"], na.rm = TRUE),
human_ribo = rowVars(voom_fit$E[ , pData(eSet_human_chimp)$species == "human" & pData(eSet_human_chimp)$seqData == "ribo"], na.rm = TRUE),
chimp_rna = rowVars(voom_fit$E[ , pData(eSet_human_chimp)$species == "chimp" & pData(eSet_human_chimp)$seqData == "rna"], na.rm = TRUE),
chimp_ribo = rowVars(voom_fit$E[ , pData(eSet_human_chimp)$species == "chimp" & pData(eSet_human_chimp)$seqData == "ribo"], na.rm = TRUE)
) ) )
require(matrixStats)
boxplot(log2(data.frame(human_rna = rowVars(obs_weighted[ , pData(eSet_human_chimp)$species == "human" & pData(eSet_human_chimp)$seqData == "rna"], na.rm = TRUE),
human_ribo = rowVars(obs_weighted[ , pData(eSet_human_chimp)$species == "human" & pData(eSet_human_chimp)$seqData == "ribo"], na.rm = TRUE),
chimp_rna = rowVars(obs_weighted[ , pData(eSet_human_chimp)$species == "chimp" & pData(eSet_human_chimp)$seqData == "rna"], na.rm = TRUE),
chimp_ribo = rowVars(obs_weighted[ , pData(eSet_human_chimp)$species == "chimp" & pData(eSet_human_chimp)$seqData == "ribo"], na.rm = TRUE)
) ) )
pData(eSet_sub)
getwd()
df <- load(file = "../rdas/eSetRRP.rda")
ls()
eSet <- eSetRRP.RP.Q.log2
eSet
eSet
fNames <- featureNames(eSet)
fNames
eSet
exprs(eSet)
dim(exprs(eSet))
str(exprs(eSet))
i = 1
mat1 <- eSet[featureNames(eSet) == fNames[i], ]
mat1
mat1
exprs(mat1)
t(exprs(mat1)
)
mat1$seqData
mat1
mat1$species
eSet
