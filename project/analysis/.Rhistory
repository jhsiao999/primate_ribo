boxplot(log2(HC.se),log2(HR.se),log2(CR.se), xlab="",main="se",ylab="log2 SE", notch=T)
axis(1,at = c(1,2,3),labels = c("HC","HR","CR"))
qvalue(HCpvalue)$pi0
qvalue(CRpvalue)$pi0
qvalue(HRpvalue)$pi0
length(which(qvalue(HCpvalue)$qvalues < 0.01))
length(which(qvalue(HRpvalue)$qvalues < 0.01))
length(which(qvalue(CRpvalue)$qvalues < 0.01))
pc<-prcomp(t(na.omit(log2.HRC.plus.mm4H.rpkm.speLength.Q)),center = T,scale = T)
barplot((pc$sdev)^2/sum((pc$sdev)^2), names.arg =  colnames(pc$x))
spec<-substring(rownames(pc$x),1,1)
temp.data<-as.data.frame(cbind(melt(pc$x),pc$x[,1],spec))
names(temp.data)<-c("ID","PC","value","pc1","species")
temp.data %>% ggplot(aes(x=pc1,y=value))+geom_point(aes(color = species))+facet_wrap(~PC)
SD.ribo.H<-apply(log2.HRC.plus.mm4H.rpkm.speLength.Q[,6:11], 1,sd,na.rm = T)
mean.ribo.H<-apply(log2.HRC.plus.mm4H.rpkm.speLength.Q[,6:11], 1,mean,na.rm = T)
SD.ribo.R<-apply(log2.HRC.plus.mm4H.rpkm.speLength.Q[,12:16], 1,sd,na.rm = T)
mean.ribo.R<-apply(log2.HRC.plus.mm4H.rpkm.speLength.Q[,12:16], 1,mean,na.rm = T)
SD.ribo.C<-apply(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1:5], 1,sd,na.rm = T)
mean.ribo.C<-apply(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1:5], 1,mean,na.rm = T)
SD.ribo.X<-apply(log2.HRC.plus.mm4H.rpkm.speLength.Q[,17:20], 1,sd,na.rm = T)
mean.ribo.X<-apply(log2.HRC.plus.mm4H.rpkm.speLength.Q[,17:20], 1,mean,na.rm = T)
boxplot(SD.ribo.H,SD.ribo.R,SD.ribo.C,SD.ribo.X ,xlab="", notch=T)
axis(1,c(1,2,3,4),c("human","rhesus","chimp","Hmm4"))
SD.ribo.H<-apply(log2.mm4.rpkm.speLength.Q[,9:12], 1,sd,na.rm = T)
mean.ribo.H<-apply(log2.mm4.rpkm.speLength.Q[,9:12], 1,mean,na.rm = T)
SD.ribo.R<-apply(log2.mm4.rpkm.speLength.Q[,5:8], 1,sd,na.rm = T)
mean.ribo.R<-apply(log2.mm4.rpkm.speLength.Q[,5:8], 1,mean,na.rm = T)
SD.ribo.C<-apply(log2.mm4.rpkm.speLength.Q[,1:4], 1,sd,na.rm = T)
mean.ribo.C<-apply(log2.mm4.rpkm.speLength.Q[,1:4], 1,mean,na.rm = T)
CV.ribo.H <- SD.ribo.H - mean.ribo.H
CV.ribo.R <- SD.ribo.R - mean.ribo.R
CV.ribo.C <- SD.ribo.C - mean.ribo.C
boxplot(SD.ribo.H,SD.ribo.R,SD.ribo.C,xlab="", notch=T)
axis(1,c(1,2,3),c("human","rhesus","chimp"))
read.xls("/Users/siddisis/Dropbox/work/Ribosome_profiling/Primate_comparison/primate_ribo_gender_mmbatch.xlsx")->cell.source
cell.source<-cell.source[,1:4]
cell.source<-cell.source[-11,]
cell.source$libmix
batch<-c(cell.source$libmix,rep("mm4",4))
batch
str(cell.source)
cell.source
batch<-c(as.character(cell.source$libmix),rep("mm4",4))
batch
head(log2.HRC.plus.mm4H.rpkm.speLength.Q)
read.xls("/Users/siddisis/Dropbox/work/Ribosome_profiling/Primate_comparison/primate_ribo_gender_mmbatch.xlsx")->cell.source
cell.source<-cell.source[,1:4]
batch<-c(as.character(cell.source$libmix),rep("mm4",4))
batch
cell.source
pc<-prcomp(t(na.omit(log2.HRC.plus.mm4H.rpkm.speLength.Q)),center = T,scale = T)
barplot((pc$sdev)^2/sum((pc$sdev)^2), names.arg =  colnames(pc$x))
spec<-substring(rownames(pc$x),1,1)
temp.data<-as.data.frame(cbind(melt(pc$x),pc$x[,1],spec,batch))
names(temp.data)<-c("ID","PC","value","pc1","species","batch")
temp.data %>% ggplot(aes(x=pc1,y=value))+geom_point(aes(color = batch))+facet_wrap(~PC)
temp.data %>% ggplot(aes(x=pc1,y=value))+geom_point(aes(color = species, shape = batch))+facet_wrap(~PC)
pc<-prcomp(t(na.omit(log2.mm4.rpkm.speLength.Q)),center = T,scale = T)
barplot((pc$sdev)^2/sum((pc$sdev)^2), names.arg =  colnames(pc$x))
spec<-substring(rownames(pc$x),1,1)
temp.data<-as.data.frame(cbind(melt(pc$x),pc$x[,1],spec))
names(temp.data)<-c("ID","PC","value","pc1","species")
temp.data %>% ggplot(aes(x=pc1,y=value))+geom_point(aes(color = species))+facet_wrap(~PC)
batch
levels(log2.HRC.plus.mm4H.rpkm.speLength.Q)
levels(batch)
levels(as.factor(batch))
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLengt.Q[1,]~as.factor(batch))
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]~as.factor(batch))
str(batch.fit)
summarise(batch.fit)
summary(batch.fit)
batch.fit$residuals
boxplot(batch.fit$residuals[1:5],batch.fit$residuals[6:11],batch.fit$residuals[12:16],batch.fit$residuals[17:20])
boxplot(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,1:5],log2.HRC.plus.mm4H.rpkm.speLength.Q[1,6:11],log2.HRC.plus.mm4H.rpkm.speLength.Q[1,12:16],log2.HRC.plus.mm4H.rpkm.speLength.Q[1,17:20])
batch
boxplot(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,1:5],log2.HRC.plus.mm4H.rpkm.speLength.Q[1,6:11],log2.HRC.plus.mm4H.rpkm.speLength.Q[1,12:16],log2.HRC.plus.mm4H.rpkm.speLength.Q[1,17:20])
boxplot(batch.fit$residuals[1:5],batch.fit$residuals[6:11],batch.fit$residuals[12:16],batch.fit$residuals[17:20])
boxplot(batch.fit$residuals[1:5],batch.fit$residuals[6:11],batch.fit$residuals[12:16],batch.fit$residuals[17:20])
log2.HRC.plus.mm4H.rpkm.speLength.Q.res<-m[length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1]),20]
for (i in 1:length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1])){
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[i,]~as.factor(batch))
log2.HRC.plus.mm4H.rpkm.speLength.Q.res[i,]<-batch.fit$residuals
}
log2.HRC.plus.mm4H.rpkm.speLength.Q.res<-matrix(,length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1]),20)
for (i in 1:length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1])){
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[i,]~as.factor(batch))
log2.HRC.plus.mm4H.rpkm.speLength.Q.res[i,]<-batch.fit$residuals
}
batch.fit$residuals
str(log2.HRC.plus.mm4H.rpkm.speLength.Q.res)
head(log2.HRC.plus.mm4H.rpkm.speLength.Q.res)
which(is.na(log2.HRC.plus.mm4H.rpkm.speLength.Q.res))
length(which(is.na(log2.HRC.plus.mm4H.rpkm.speLength.Q.res)))
head(log2.HRC.plus.mm4H.rpkm.speLength.Q.res)
tail(log2.HRC.plus.mm4H.rpkm.speLength.Q.res)
str(log2.HRC.plus.mm4H.rpkm.speLength.Q)
str(as.matrix(log2.HRC.plus.mm4H.rpkm.speLength.Q))
str(log2.HRC.plus.mm4H.rpkm.speLength.Q, drop.levels=T)
str(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1])
length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1])
str(log2.HRC.plus.mm4H.rpkm.speLength.Q.res)
tail(log2.HRC.plus.mm4H.rpkm.speLength.Q.res)
tail(log2.HRC.plus.mm4H.rpkm.speLength.Q.res,n=30)
log2.HRC.plus.mm4H.rpkm.speLength.Q.res<-matrix(,length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1]),20)
tail(log2.HRC.plus.mm4H.rpkm.speLength.Q.res,n=30)
hed(log2.HRC.plus.mm4H.rpkm.speLength.Q.res)
head(log2.HRC.plus.mm4H.rpkm.speLength.Q.res)
?lm()
log2.HRC.plus.mm4H.rpkm.speLength.Q.res<-matrix(,length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1]),20)
for (i in 1:length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1])){
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[i,]~as.factor(batch),na.action = Null)
log2.HRC.plus.mm4H.rpkm.speLength.Q.res[i,]<-batch.fit$residuals
}
log2.HRC.plus.mm4H.rpkm.speLength.Q.res<-matrix(,length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1]),20)
for (i in 1:length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1])){
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[i,]~as.factor(batch),na.action=NULL)
log2.HRC.plus.mm4H.rpkm.speLength.Q.res[i,]<-batch.fit$residuals
}
log2.HRC.plus.mm4H.rpkm.speLength.Q.res<-matrix(,length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1]),20)
for (i in 1:length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1])){
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[i,]~as.factor(batch),na.exclude=T)
log2.HRC.plus.mm4H.rpkm.speLength.Q.res[i,]<-batch.fit$residuals
}
log2.HRC.plus.mm4H.rpkm.speLength.Q.res<-matrix(,length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1]),20)
for (i in 1:length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1])){
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[i,]~as.factor(batch))
log2.HRC.plus.mm4H.rpkm.speLength.Q.res[i,]<-batch.fit$residuals
}
log2.HRC.plus.mm4H.rpkm.speLength.Q.res<-matrix(,length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1]),20)
for (i in 1:length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1])){
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[i,]~as.factor(batch))
log2.HRC.plus.mm4H.rpkm.speLength.Q.res<-merge(log2.HRC.plus.mm4H.rpkm.speLength.Q.res,batch.fit$residuals)
}
str(log2.HRC.plus.mm4H.rpkm.speLength.Q.res)
head(log2.HRC.plus.mm4H.rpkm.speLength.Q.res)
batch.fit
batch.fit$residuals
str(batch.fit$residuals)
head(log2.HRC.plus.mm4H.rpkm.speLength.Q)
str(log2.HRC.plus.mm4H.rpkm.speLength.Q)
names(log2.HRC.plus.mm4H.rpkm.speLength.Q)
names(batch.fit$residuals)
log2.HRC.plus.mm4H.rpkm.speLength.Q.res<-matrix(,length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1]),20)
for (i in 1:length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1])){
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[i,]~as.factor(batch))
log2.HRC.plus.mm4H.rpkm.speLength.Q.res<-merge(log2.HRC.plus.mm4H.rpkm.speLength.Q.res,batch.fit$residuals, by = "names")
}
log2.HRC.plus.mm4H.rpkm.speLength.Q.res<-matrix(,length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1]),20)
for (i in 1:length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1])){
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[i,]~as.factor(batch))
log2.HRC.plus.mm4H.rpkm.speLength.Q.res<-merge(log2.HRC.plus.mm4H.rpkm.speLength.Q.res,batch.fit$residuals, by = names)
}
log2.HRC.plus.mm4H.rpkm.speLength.Q.res<-matrix(,length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1]),20)
for (i in 1:length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1])){
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[i,]~as.factor(batch))
log2.HRC.plus.mm4H.rpkm.speLength.Q.res<-merge(log2.HRC.plus.mm4H.rpkm.speLength.Q.res,batch.fit$residuals, by = names(batch.fit$residuals))
}
names(log2.HRC.plus.mm4H.rpkm.speLength.Q)
str(log2.HRC.plus.mm4H.rpkm.speLength.Q)
log2.HRC.plus.mm4H.rpkm.speLength.Q[2]
log2.HRC.plus.mm4H.rpkm.speLength.Q[[2]]
log2.HRC.plus.mm4H.rpkm.speLength.Q[1],
log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]
log2.HRC.plus.mm4H.rpkm.speLength.Q$chr
log2.HRC.plus.mm4H.rpkm.speLength.Q$dimnames
sumary(log2.HRC.plus.mm4H.rpkm.speLength.Q)
summary(log2.HRC.plus.mm4H.rpkm.speLength.Q)
str(summary(log2.HRC.plus.mm4H.rpkm.speLength.Q))
attr(log2.HRC.plus.mm4H.rpkm.speLength.Q)
attr(log2.HRC.plus.mm4H.rpkm.speLength.Q,"dimnames")
attr(log2.HRC.plus.mm4H.rpkm.speLength.Q,"dimnames")[[2]]
log2.HRC.plus.mm4H.rpkm.speLength.Q.res<-attr(log2.HRC.plus.mm4H.rpkm.speLength.Q,"dimnames")[[2]]
for (i in 1:length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1])){
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[i,]~as.factor(batch))
log2.HRC.plus.mm4H.rpkm.speLength.Q.res<-rbind(log2.HRC.plus.mm4H.rpkm.speLength.Q.res,batch.fit$residuals)
}
str(log2.HRC.plus.mm4H.rpkm.speLength.Q.res)
head(log2.HRC.plus.mm4H.rpkm.speLength.Q.res)
str(log2.HRC.plus.mm4H.rpkm.speLength.Q.res)
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q~as.factor(batch))
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]~as.factor(batch))
batch.fit<-lm(t(log2.HRC.plus.mm4H.rpkm.speLength.Q)~as.factor(batch))
str(batch)
head(batch)
str(t(log2.HRC.plus.mm4H.rpkm.speLength.Q))
t(log2.HRC.plus.mm4H.rpkm.speLength.Q)[,1]
lm(t(log2.HRC.plus.mm4H.rpkm.speLength.Q)[,1]~as.factor(batch))
batch.fit<-lm(t(log2.HRC.plus.mm4H.rpkm.speLength.Q)~as.factor(batch))
batch.fit
str(batch.fit)
str(batch.fit$residuals)
head(batch.fit$residuals)
head(t(batch.fit$residuals))
tail(t(batch.fit$residuals))
batch.fit<-lm(t(log2.HRC.plus.mm4H.rpkm.speLength.Q)~as.factor(batch))
log2.HRC.plus.mm4H.rpkm.speLength.Q.res<-t(batch.fit$residuals)
head(log2.HRC.plus.mm4H.rpkm.speLength.Q.res)
str(batch.fit)
boxplot(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,1:5],log2.HRC.plus.mm4H.rpkm.speLength.Q[1,6:11],log2.HRC.plus.mm4H.rpkm.speLength.Q[1,12:16],log2.HRC.plus.mm4H.rpkm.speLength.Q[1,17:20])
boxplot(log2.HRC.plus.mm4H.rpkm.speLength.Q.res[1,1:5],log2.HRC.plus.mm4H.rpkm.speLength.Q.res[1,6:11],log2.HRC.plus.mm4H.rpkm.speLength.Q.res[1,12:16],log2.HRC.plus.mm4H.rpkm.speLength.Q.res[1,17:20])
head(log2.HRC.plus.mm4H.rpkm.speLength.Q.res)
boxplot(log2.HRC.plus.mm4H.rpkm.speLength.Q.res[1,1:4],log2.HRC.plus.mm4H.rpkm.speLength.Q.res[1,5:8],log2.HRC.plus.mm4H.rpkm.speLength.Q.res[1,9:13],log2.HRC.plus.mm4H.rpkm.speLength.Q.res[1,14:16])
boxplot(log2.HRC.plus.mm4H.rpkm.speLength.Q.res[2,1:4],log2.HRC.plus.mm4H.rpkm.speLength.Q.res[2,5:8],log2.HRC.plus.mm4H.rpkm.speLength.Q.res[2,9:13],log2.HRC.plus.mm4H.rpkm.speLength.Q.res[2,14:16])
boxplot(log2.HRC.plus.mm4H.rpkm.speLength.Q.res[2,1:5],log2.HRC.plus.mm4H.rpkm.speLength.Q.res[2,6:11],log2.HRC.plus.mm4H.rpkm.speLength.Q.res[2,12:16],log2.HRC.plus.mm4H.rpkm.speLength.Q.res[2,17:20])
boxplot(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,1:5],log2.HRC.plus.mm4H.rpkm.speLength.Q[1,6:11],log2.HRC.plus.mm4H.rpkm.speLength.Q[1,12:16],log2.HRC.plus.mm4H.rpkm.speLength.Q[1,17:20])
boxplot(log2.HRC.plus.mm4H.rpkm.speLength.Q[2,1:5],log2.HRC.plus.mm4H.rpkm.speLength.Q[2,6:11],log2.HRC.plus.mm4H.rpkm.speLength.Q[2,12:16],log2.HRC.plus.mm4H.rpkm.speLength.Q[2,17:20])
boxplot(log2.HRC.plus.mm4H.rpkm.speLength.Q.res[2,1:4],log2.HRC.plus.mm4H.rpkm.speLength.Q.res[2,5:8],log2.HRC.plus.mm4H.rpkm.speLength.Q.res[2,9:13],log2.HRC.plus.mm4H.rpkm.speLength.Q.res[2,14:16])
pc<-prcomp(t(na.omit(log2.HRC.plus.mm4H.rpkm.speLength.Q.res)),center = T,scale = T)
barplot((pc$sdev)^2/sum((pc$sdev)^2), names.arg =  colnames(pc$x))
spec<-substring(rownames(pc$x),1,1)
temp.data<-as.data.frame(cbind(melt(pc$x),pc$x[,1],spec))
names(temp.data)<-c("ID","PC","value","pc1","species")
temp.data %>% ggplot(aes(x=pc1,y=value))+geom_point(aes(color = species))+facet_wrap(~PC)
batch
levels(batch)
levels(as.factor(batch))
as.numeric(levels(as.factor(batch)))
levels(as.numeric(as.factor(batch)))
levels(as.factor(batch))
as.numeric(as.factor(batch))
pc<-prcomp(batch.fit$residuals,center = T,scale = T)
barplot((pc$sdev)^2/sum((pc$sdev)^2), names.arg =  colnames(pc$x))
spec<-substring(rownames(pc$x),1,1)
temp.data<-as.data.frame(cbind(melt(pc$x),pc$x[,1],spec))
names(temp.data)<-c("ID","PC","value","pc1","species")
temp.data %>% ggplot(aes(x=pc1,y=value))+geom_point(aes(color = species))+facet_wrap(~PC)
batch.fit
summary(batch.fit)
batch
levels(batch)
levels(as.factor(batch))
lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]~as.factor(batch))
summary(lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]~as.factor(batch)))
head(log2.HRC.plus.mm4H.rpkm.speLength.Q)
cor(log2.HRC.plus.mm4H.rpkm.speLength.Q[,6:11],log2.HRC.plus.mm4H.rpkm.speLength.Q[,17:20])
cor(log2.HRC.plus.mm4H.rpkm.speLength.Q[,6:11],log2.HRC.plus.mm4H.rpkm.speLength.Q[,17:20],use = complete.obs)
cor(log2.HRC.plus.mm4H.rpkm.speLength.Q[,6:11],log2.HRC.plus.mm4H.rpkm.speLength.Q[,17:20],use = "complete.obs")
cor(log2.HRC.plus.mm4H.rpkm.speLength.Q[,6:11],log2.HRC.plus.mm4H.rpkm.speLength.Q[,1:5],use = "complete.obs")
levels(as.factor(batch))
levels(as.factor(batch)) <- c(3,2,1,4,5)
levels(as.factor(batch)) <- levels(3,2,1,4,5)
levels(3,2,1,4,5)
c(3,2,1,4,5)
levels(as.factor(batch)) <- c(3,2,1,4,5)
batch
levels(as.factor(batch))
levels(as.factor(batch)) <- c(3,2,1,4,5)
batch
batch.rc <- c(1,1,1,2,1,3,3,3,3,4,5,2,1,1,1,1,1,1,1,1)
length(batch.rc)
batch
bbatch.fit
batch.rc
levels(batch.rc)
batch.fit<-lm(t(log2.HRC.plus.mm4H.rpkm.speLength.Q)~as.factor(batch.rc))
pc<-prcomp(batch.fit$residuals,center = T,scale = T)
barplot((pc$sdev)^2/sum((pc$sdev)^2), names.arg =  colnames(pc$x))
spec<-substring(rownames(pc$x),1,1)
temp.data<-as.data.frame(cbind(melt(pc$x),pc$x[,1],spec))
names(temp.data)<-c("ID","PC","value","pc1","species")
temp.data %>% ggplot(aes(x=pc1,y=value))+geom_point(aes(color = species))+facet_wrap(~PC)
str(batch.fit)
str(batch.fit$coefficients)
batch.fit$coefficients[,1]
str(batch.fit$residuals)
head(batch.fit$residuals[,1])
boxplot(batch.fit$residuals[1:4,1])
batch.fit$residuals[,1]
boxplot(batch.fit$residuals[1:4,1],batch.fit$residuals[5:8,1],batch.fit$residuals[9:13,1],batch.fit$residuals[14:16,1])
batch
batch.rc
batch.fit$coefficients
batch.fit$coefficients[1]
batch.fit$coefficients[1,]
batch.fit$coefficients[,1]
batch.fit$coefficients[,2]
batch.fit$coefficients[,3]
batch.fit<-lm(t(log2.HRC.plus.mm4H.rpkm.speLength.Q)~as.factor(batch))
batch.fit$coefficients[,1]
batch.fit$coefficients[,2]
batch.fit$coefficients[,3]
batch.rc
batch
str(batch.fit$residuals)
batch.fit$residuals[,1]
pc<-prcomp(batch.fit$residuals[,1:13],center = T,scale = T)
barplot((pc$sdev)^2/sum((pc$sdev)^2), names.arg =  colnames(pc$x))
spec<-substring(rownames(pc$x),1,1)
temp.data<-as.data.frame(cbind(melt(pc$x),pc$x[,1],spec))
names(temp.data)<-c("ID","PC","value","pc1","species")
temp.data %>% ggplot(aes(x=pc1,y=value))+geom_point(aes(color = species))+facet_wrap(~PC)
atch.fit$residuals[1,1:13]
batch.fit$residuals[1,1:13]
str(batch.fit$residuals[1,1:13])
rownames(pc$x)
str(pc$x)
str(batch.fit$residuals[,1:13])
str(batch.fit$residuals)
pc<-prcomp(batch.fit$residuals[1:13,],center = T,scale = T)
barplot((pc$sdev)^2/sum((pc$sdev)^2), names.arg =  colnames(pc$x))
spec<-substring(rownames(pc$x),1,1)
temp.data<-as.data.frame(cbind(melt(pc$x),pc$x[,1],spec))
names(temp.data)<-c("ID","PC","value","pc1","species")
temp.data %>% ggplot(aes(x=pc1,y=value))+geom_point(aes(color = species))+facet_wrap(~PC)
batch.fit<-glm(t(log2.HRC.plus.mm4H.rpkm.speLength.Q)~as.factor(batch))
?glm
batch.fit<-glm(t(log2.HRC.plus.mm4H.rpkm.speLength.Q)~as.factor(batch),family = gaussian)
str(batch.fit$residuals)
batch.fit$residuals[,1]
rm(batch.fit)
batch.fit$residuals[,1]
batch.fit<-glm(t(log2.HRC.plus.mm4H.rpkm.speLength.Q)~as.factor(batch),family = gaussian)
batch.fit$residuals[,1]
str(as.factor(batch))
str(log2.HRC.plus.mm4H.rpkm.speLength.Q)
glm(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]~as.factor(batch),family = gaussian)
glm(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]~as.factor(batch),family = gaussian)$residual
batch.fit<-glm(log2.HRC.plus.mm4H.rpkm.speLength.Q~as.factor(batch),family = gaussian)
batch.fit<-glm(t(log2.HRC.plus.mm4H.rpkm.speLength.Q)~as.factor(batch),family = gaussian)
batch.fit<-glm(t(log2.HRC.plus.mm4H.rpkm.speLength.Q)~as.factor(batch),family = gaussian, na.action = na.omit)
batch.fit<-lm(t(log2.HRC.plus.mm4H.rpkm.speLength.Q)~as.factor(batch),family = gaussian, na.action = na.omit)
batch.fit<-lm(t(log2.HRC.plus.mm4H.rpkm.speLength.Q)~as.factor(batch), na.action = na.omit)
batch.fit$residuals[,1]
batch.fit<-lm(t(log2.HRC.plus.mm4H.rpkm.speLength.Q)~as.factor(batch), na.action = na.exclude)
pc<-prcomp(na.omit(batch.fit$residuals),center = T,scale = T)
barplot((pc$sdev)^2/sum((pc$sdev)^2), names.arg =  colnames(pc$x))
spec<-substring(rownames(pc$x),1,1)
temp.data<-as.data.frame(cbind(melt(pc$x),pc$x[,1],spec))
names(temp.data)<-c("ID","PC","value","pc1","species")
temp.data %>% ggplot(aes(x=pc1,y=value))+geom_point(aes(color = species))+facet_wrap(~PC)
str(batch.fit$residuals)
batch.fit$residuals[,1]
batch.fit<-lm(t(log2.HRC.plus.mm4H.rpkm.speLength.Q)~as.factor(batch), na.action = na.exclude())
batch.fit<-lm(t(log2.HRC.plus.mm4H.rpkm.speLength.Q)~as.factor(batch), na.action = na.exclude)
pc<-prcomp(na.omit(residuals(batch.fit)),center = T,scale = T)
barplot((pc$sdev)^2/sum((pc$sdev)^2), names.arg =  colnames(pc$x))
spec<-substring(rownames(pc$x),1,1)
temp.data<-as.data.frame(cbind(melt(pc$x),pc$x[,1],spec))
names(temp.data)<-c("ID","PC","value","pc1","species")
temp.data %>% ggplot(aes(x=pc1,y=value))+geom_point(aes(color = species))+facet_wrap(~PC)
str(residuals(batch.fit))
residuals(batch.fit)[,1]
residuals(batch.fit)[,2]
residuals(batch.fit)[,3]
batch.fit<-lm(t(log2.HRC.plus.mm4H.rpkm.speLength.Q)~as.factor(batch))
pc<-prcomp(residuals(batch.fit),center = T,scale = T)
barplot((pc$sdev)^2/sum((pc$sdev)^2), names.arg =  colnames(pc$x))
spec<-substring(rownames(pc$x),1,1)
temp.data<-as.data.frame(cbind(melt(pc$x),pc$x[,1],spec))
names(temp.data)<-c("ID","PC","value","pc1","species")
temp.data %>% ggplot(aes(x=pc1,y=value))+geom_point(aes(color = species))+facet_wrap(~PC)
str(residuals(batch.fit))
residuals(batch.fit)[,1]
log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]
batch
log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]
log2.HRC.plus.mm4H.rpkm.speLength.Q[2,]
log2.HRC.plus.mm4H.rpkm.speLength.Q[2,-1]
log2.HRC.plus.mm4H.rpkm.speLength.Q[1,-1]
log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]
log2.HRC.plus.mm4H.rpkm.speLength.Q[2,-1]
rbind(log2.HRC.plus.mm4H.rpkm.speLength.Q[2,-1],log2.HRC.plus.mm4H.rpkm.speLength.Q[1,])
rbind(log2.HRC.plus.mm4H.rpkm.speLength.Q[2,-1],log2.HRC.plus.mm4H.rpkm.speLength.Q[1,])
rbind(log2.HRC.plus.mm4H.rpkm.speLength.Q[2,-1],log2.HRC.plus.mm4H.rpkm.speLength.Q[1,],deparse.level = F)
?rbind
rbind(log2.HRC.plus.mm4H.rpkm.speLength.Q[2,-1],log2.HRC.plus.mm4H.rpkm.speLength.Q[1,])
rbind(log2.HRC.plus.mm4H.rpkm.speLength.Q[2,-1],as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]))
rbind(as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[2,-1]),as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]))
merge(as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[2,-1]),as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]))
merge(as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[2,-1]),as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]), by = names)
merge(as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[2,-1]),as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]), by = colnames())
merge(as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[2,-1]),as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]), by = colnames
)
merge(as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[2,-1]),as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]))
merge(as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[2,]),as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]))
merge(as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[2,]),as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]),by=names(log2.HRC.plus.mm4H.rpkm.speLength.Q))
names(log2.HRC.plus.mm4H.rpkm.speLength.Q)
attributes(log2.HRC.plus.mm4H.rpkm.speLength.Q)
attributes(log2.HRC.plus.mm4H.rpkm.speLength.Q)[[2]]
attributes(log2.HRC.plus.mm4H.rpkm.speLength.Q)$dimnames[[2]]
merge(as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[2,]),as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]),by= attributes(log2.HRC.plus.mm4H.rpkm.speLength.Q)$dimnames[[2]])
merge(as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[2,]),as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]),by= log2.HRC.plus.mm4H.rpkm.speLength.Q$dimnames[[2]])
log2.HRC.plus.mm4H.rpkm.speLength.Q$dimnames[[2]]
merge(as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[2,]),as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]),by=as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,] )
)
merge(as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[2,]),as.data.frame(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]),by=log2.HRC.plus.mm4H.rpkm.speLength.Q[1,] )
merge(log2.HRC.plus.mm4H.rpkm.speLength.Q[2,],log2.HRC.plus.mm4H.rpkm.speLength.Q[1,],by=log2.HRC.plus.mm4H.rpkm.speLength.Q[1,])
merge(log2.HRC.plus.mm4H.rpkm.speLength.Q[2,],log2.HRC.plus.mm4H.rpkm.speLength.Q[1,])
library(plyr)
res.list<-list()
str(res.list)
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]~as.factor(batch))
res.list[1]<-batch.fit$residuals
res.list
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]~as.factor(batch))
res.list<-list(res.list,batch.fit$residuals)
res.list
res.list<-list()
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[1,]~as.factor(batch))
res.list<-list(res.list,batch.fit$residuals)
res.list
for (i in 1:5){
#length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1])){
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[i,]~as.factor(batch))
res.list<-list(res.list,batch.fit$residuals)
#batch.fit<-lm(t(log2.HRC.plus.mm4H.rpkm.speLength.Q)~as.factor(batch.rc))
}
res.list
res.list<-list()
for (i in 1:5){
#length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1])){
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[i,]~as.factor(batch))
res.list[[i]]<-batch.fit$residuals
#batch.fit<-lm(t(log2.HRC.plus.mm4H.rpkm.speLength.Q)~as.factor(batch.rc))
}
res.list
res.list<-list()
for (i in 1:length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1])){
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[i,]~as.factor(batch))
res.list[[i]]<-batch.fit$residuals
}
library(plyr)
batch.fit.res<-do.call(rbind.fill, res.list)
str(res.list)
res.list<-list()
for (i in 1:length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1])){
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[i,]~as.factor(batch))
res.list[[i]]<-as.data.frame(batch.fit$residuals)
}
library(plyr)
batch.fit.res<-do.call(rbind.fill, res.list)
str(batch.fit.res)
head(batch.fit)
head(batch.fit.res)
library(dplyr)
batch.fit.res<-rbind_all(res.list)
str(batch.fit.res)
as.data.frame(batch.fit$residuals)
batch.fit.res<-cbind_all(res.list)
names(batch.fit$residuals)
batch.fit.res<-rbind_all(res.list,id = names)
str(batch.fit.res)
batch.fit.res<-rbind_all(res.list,id = names(batch.fit$residuals))
batch.fit.res<-rbind_all(res.list)
str(batch.fit.res)
head(batch.fit.res)
pc<-prcomp(na.omit(t(batch.fit.res)),center = T,scale = T)
for (i in 1:5){
#     1:length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1])){
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[i,]~as.factor(batch))
res.list[[i]]<-as.data.frame(t(batch.fit$residuals))
}
batch.fit.res<-rbind_all(res.list)
str(batch.fit.res)
res.list
res.list<-list()
for (i in 1:5){
#     1:length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1])){
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[i,]~as.factor(batch))
res.list[[i]]<-as.data.frame(t(batch.fit$residuals))
}
str(batch.fit.res)
res.list
batch.fit.res<-rbind_all(res.list)
str(batch.fit.res)
head(batch.fit.res)
res.list<-list()
for (i in 1:length(log2.HRC.plus.mm4H.rpkm.speLength.Q[,1])){
batch.fit<-lm(log2.HRC.plus.mm4H.rpkm.speLength.Q[i,]~as.factor(batch))
res.list[[i]]<-as.data.frame(t(batch.fit$residuals))
}
library(dplyr)
batch.fit.res<-rbind_all(res.list)
batch.fit$residuals
str(batch.fit$residuals)
dim(batch.fit$residuals)
t(batch.fit$residuals)
batch.fit$residuals
t(batch.fit$residuals)
str(t(batch.fit$residuals))
str(batch.fit$residuals)
dim(batch.fit$residuals)
dim(t(batch.fit$residuals))
str(batch.fit.res)
head(batch.fit.res)
pc<-prcomp(na.omit(t(batch.fit.res)),center = T,scale = T)
barplot((pc$sdev)^2/sum((pc$sdev)^2), names.arg =  colnames(pc$x))
spec<-substring(rownames(pc$x),1,1)
temp.data<-as.data.frame(cbind(melt(pc$x),pc$x[,1],spec))
names(temp.data)<-c("ID","PC","value","pc1","species")
temp.data %>% ggplot(aes(x=pc1,y=value))+geom_point(aes(color = species))+facet_wrap(~PC)
pc<-prcomp(t(na.omit(batch.fit.res)),center = T,scale = T)
barplot((pc$sdev)^2/sum((pc$sdev)^2), names.arg =  colnames(pc$x))
spec<-substring(rownames(pc$x),1,1)
temp.data<-as.data.frame(cbind(melt(pc$x),pc$x[,1],spec))
names(temp.data)<-c("ID","PC","value","pc1","species")
temp.data %>% ggplot(aes(x=pc1,y=value))+geom_point(aes(color = species))+facet_wrap(~PC)
batch
temp.data<-as.data.frame(cbind(melt(pc$x),pc$x[,1],spec,batch))
names(temp.data)<-c("ID","PC","value","pc1","species","batch")
temp.data %>% ggplot(aes(x=pc1,y=value))+geom_point(aes(color = species, shape=batch))+facet_wrap(~PC)
pc<-prcomp(t(na.omit(log2.HRC.plus.mm4H.rpkm.speLength.Q)),center = T,scale = T)
barplot((pc$sdev)^2/sum((pc$sdev)^2), names.arg =  colnames(pc$x))
spec<-substring(rownames(pc$x),1,1)
temp.data<-as.data.frame(cbind(melt(pc$x),pc$x[,1],spec,batch))
names(temp.data)<-c("ID","PC","value","pc1","species","batch")
temp.data %>% ggplot(aes(x=pc1,y=value))+geom_point(aes(color = species))+facet_wrap(~PC)
temp.data %>% ggplot(aes(x=pc1,y=value))+geom_point(aes(color = species, shape = batch))+facet_wrap(~PC)
ls()
ls()
