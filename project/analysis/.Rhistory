ii = eSet.temp$species==c("human","chimp")[i]
eSet.tt = eSet.temp[,ii]
emat = lapply(seq_along(c("ribo","rna","protein")),function(j) {
jj = eSet.tt$seqData==c("ribo","rna","protein")[j]
rowMeans(exprs(eSet.tt[,jj]),na.rm=TRUE)
})
emat=do.call(cbind,emat)
colnames(emat)=c("ribo","rna","protein")
return(data.frame(emat))
})
names(fc.mat)=c("human","chimp")
dmat_unnormed = data.frame(ribo=fc.mat$human$ribo-fc.mat$chimp$ribo,
rna=fc.mat$human$rna-fc.mat$chimp$rna,
pro=fc.mat$human$protein-fc.mat$chimp$protein)
xy.rnapro = data.frame(rna=dmat_unnormed$rna,
pro=dmat_unnormed$pro)
xy.riborna = data.frame(rna=dmat_unnormed$rna,
ribo=dmat_unnormed$ribo)
xy.ribopro = data.frame(ribo=dmat_unnormed$ribo,
pro=dmat_unnormed$pro)
ii_rnaGTpro = res.rnapro$int.qval<.01 & ( (abs(xy.rnapro$rna) > abs(xy.rnapro$pro)) | (xy.rnapro$rna * xy.rnapro$pro < 0) )
ii_rnaGTpro = res.rnapro$int.qval<.01 & ( (abs(xy.rnapro$rna) > abs(xy.rnapro$pro)) | (xy.rnapro$rna * xy.rnapro$pro < 0) )
ii_proGTrna = res.rnapro$int.qval<.01 & ( (abs(xy.rnapro$pro) > abs(xy.rnapro$rna)) & (xy.rnapro$rna * xy.rnapro$pro > 0 ) )
ii_proNULLrna = (!(ii_rnaGTpro|ii_proGTrna))
ii_rnaGTribo <-
res.riborna$int.qval<.01 & ( (abs(xy.riborna$rna) > abs(xy.riborna$ribo)) | (xy.riborna$rna * xy.riborna$ribo < 0) )
ii_riboGTrna <-
res.riborna$int.qval<.01 & ( (abs(xy.riborna$ribo) > abs(xy.riborna$rna)) & (xy.riborna$rna * xy.riborna$ribo > 0 ) )
# Attenuated divergence
ii_rnaGTribo <-
res.riborna$int.qval<.01 & ( (abs(xy.riborna$rna) > abs(xy.riborna$ribo)) | (xy.riborna$rna * xy.riborna$ribo < 0) )
# Enhanced divegence
ii_riboGTrna <-
res.riborna$int.qval<.01 & ( (abs(xy.riborna$ribo) > abs(xy.riborna$rna)) & (xy.riborna$rna * xy.riborna$ribo > 0 ) )
# Null divergence
ii_riboNULLrna <- (!(ii_rnaGTribo|ii_riboGTrna))
sum(ii_rnaGTribo)
sum(ii_rnaGTpro*ii_rnaGTribo)
sum(ii_rnaGTribo)
sum(ii_rnaGTpro*ii_rnaGTribo)/sum(ii_rnaGTribo)
sum(ii_riboGTrna)
sum(ii_proGTrna*ii_riboGTrna)/sum(ii_riboGTrna)
# Attenuated divergence
ii_riboGTrna_rna_ref <-
res.riborna$int.qval<.01 & ( (abs(xy.riborna$ribo) > abs(xy.riborna$rna)) | (xy.riborna$rna * xy.riborna$ribo < 0) )
# Enhanced divegence
ii_rnaGTribo_rna_ref <-
res.riborna$int.qval<.01 & ( (abs(xy.riborna$rna) > abs(xy.riborna$ribo)) & (xy.riborna$rna * xy.riborna$ribo > 0 ) )
# Null divergence
ii_riboNULLrna_rna_ref <- (!(ii_riboGTrna_rna_ref|ii_rnaGTribo_rna_ref))
mat_riborna_rna_ref <-
matrix(0, 2, 1,
dimnames = list(row = c("# genes attenuated at RNA relative to Ribo",
"# genes enhanced at RNA relative to Ribo") ) )
mat_riborna_rna_ref[1,1] <- sum(ii_riboGTrna_rna_ref)
mat_rnaribo_rna_ref[2,1] <- sum(ii_rnaGTribo_rna_ref)
mat_riborna_rna_ref <-
matrix(0, 2, 1,
dimnames = list(row = c("# genes attenuated at RNA relative to Ribo",
"# genes enhanced at RNA relative to Ribo") ) )
mat_riborna_rna_ref[1,1] <- sum(ii_riboGTrna_rna_ref)
mat_riborna_rna_ref[2,1] <- sum(ii_rnaGTribo_rna_ref)
mat_riborna_rna_ref
sum(ii_rnaGTribo)
# Attenuated divergence
ii_riboGTrna_rna_ref <-
res.riborna$int.qval<.01 & ( (abs(xy.riborna$ribo) > abs(xy.riborna$rna)) | (xy.riborna$rna * xy.riborna$ribo < 0) )
# Enhanced divegence
ii_rnaGTribo_rna_ref <-
res.riborna$int.qval<.01 & ( (abs(xy.riborna$rna) > abs(xy.riborna$ribo)) & (xy.riborna$rna * xy.riborna$ribo > 0 ) )
# Null divergence
ii_riboNULLrna_rna_ref <- (!(ii_riboGTrna_rna_ref|ii_rnaGTribo_rna_ref))
mat_riborna_rna_ref <-
matrix(0, 2, 1,
dimnames = list(row = c("# genes attenuated at RNA relative to Ribo",
"# genes enhanced at RNA relative to Ribo") ) )
mat_riborna_rna_ref[1,1] <- sum(ii_riboGTrna_rna_ref)
mat_riborna_rna_ref[2,1] <- sum(ii_rnaGTribo_rna_ref)
mat_riborna_rna_ref
sum(res.riborna$int.qval < .01 & xy.riborna$rna*xy.riborna$ribo < 0)
sum( res.riborna$int.qval<.01 & (xy.riborna$rna * xy.riborna$ribo < 0)) )
sum( res.riborna$int.qval<.01 & (xy.riborna$rna * xy.riborna$ribo < 0) )
ii_riboGTrna_rna_ref <-
res.riborna$int.qval<.01 & ( (abs(xy.riborna$ribo) > abs(xy.riborna$rna)) | (xy.riborna$rna * xy.riborna$ribo < 0) )
sum(ii_riboGTrna_rna_ref)
433-324
sum( res.riborna$int.qval<.01 & (xy.riborna$rna * xy.riborna$ribo < 0)
& (abs(xy.riborna$ribo) > abs(xy.riborna$rna) ) )
sum( res.riborna$int.qval<.01 & (xy.riborna$rna * xy.riborna$ribo < 0)
& (abs(xy.riborna$ribo) < abs(xy.riborna$rna) ) )
sum( res.riborna$int.qval<.01 & (xy.riborna$rna * xy.riborna$ribo < 0)
& (abs(xy.riborna$ribo) > abs(xy.riborna$rna) ) )
433-181
ii_riboGTrna_rna_ref <-
res.riborna$int.qval<.01 & ( (abs(xy.riborna$ribo) > abs(xy.riborna$rna)) | (xy.riborna$rna * xy.riborna$ribo < 0) )
sum(ii_riboGTrna_rna_ref)
# Attenuated divergence
ii_riboGTrna_rna_ref <-
res.riborna$int.qval<.01 & ( (abs(xy.riborna$ribo) > abs(xy.riborna$rna)) | (xy.riborna$rna * xy.riborna$ribo < 0) )
sum(ii_riboGTrna_rna_ref)
# Enhanced divegence
ii_rnaGTribo_rna_ref <-
res.riborna$int.qval<.01 & ( (abs(xy.riborna$rna) > abs(xy.riborna$ribo)) & (xy.riborna$rna * xy.riborna$ribo > 0 ) )
sum(ii_rnaGTribo_rna_ref)
sum( res.riborna$int.qval<.01 & (xy.riborna$rna * xy.riborna$ribo < 0)
& (abs(xy.riborna$ribo) < abs(xy.riborna$rna) ) )
sum( res.riborna$int.qval<.01 & (xy.riborna$rna * xy.riborna$ribo < 0)
& (abs(xy.riborna$ribo) > abs(xy.riborna$rna) ) )
sum( res.riborna$int.qval<.01 & (xy.riborna$rna * xy.riborna$ribo < 0) )
sum( res.riborna$int.qval<.01 & (xy.riborna$rna * xy.riborna$ribo < 0)
& (abs(xy.riborna$ribo) > abs(xy.riborna$rna) ) )
sum( res.riborna$int.qval<.01 & (xy.riborna$rna * xy.riborna$ribo < 0)
& (abs(xy.riborna$ribo) < abs(xy.riborna$rna) ) )
433-181
45 + 143
45+181
433-181
ii_riboGTrna = res.riborna$int.qval<.01 & (abs(xy.riborna$ribo) > abs(xy.riborna$rna))
ii_rnaGTribo = res.riborna$int.qval<.01 & (abs(xy.riborna$ribo) < abs(xy.riborna$rna))
ii_rnaGTpro = res.rnapro$int.qval<.01 & (abs(xy.rnapro$rna) > abs(xy.rnapro$pro))
ii_proGTrna = res.rnapro$int.qval<.01 & (abs(xy.rnapro$pro) > abs(xy.rnapro$rna))
ii_proNULLrna = (!(ii_rnaGTpro|ii_proGTrna))
sum(ii_riboGTrna)
sum(ii_riboGTrna)
sum(ii_rnaGTribo)
## load LRT results of RNA vs. Protein divergence
load(file.path(rdadir,"rnapro.rda"))
## load LRT results of Ribo vs. RNA divergence
load(file.path(rdadir,"TEnew.rda"))
## Compute fold changes based on un-normalized data
## from the object eSetRRP.log2 in eSetRRP.rda
load(file.path(rdadir,"eSetRRP.rda"))
eSet.temp = eSetRRP.log2[ ,eSetRRP.log2$species!="rhesus"]
fc.mat=lapply(seq_along(c("human","chimp")), function(i) {
ii = eSet.temp$species==c("human","chimp")[i]
eSet.tt = eSet.temp[,ii]
emat = lapply(seq_along(c("ribo","rna","protein")),function(j) {
jj = eSet.tt$seqData==c("ribo","rna","protein")[j]
rowMeans(exprs(eSet.tt[,jj]),na.rm=TRUE)
})
emat=do.call(cbind,emat)
colnames(emat)=c("ribo","rna","protein")
return(data.frame(emat))
})
names(fc.mat)=c("human","chimp")
dmat_unnormed = data.frame(ribo=fc.mat$human$ribo-fc.mat$chimp$ribo,
rna=fc.mat$human$rna-fc.mat$chimp$rna,
pro=fc.mat$human$protein-fc.mat$chimp$protein)
xy.rnapro = data.frame(rna=dmat_unnormed$rna,
pro=dmat_unnormed$pro)
xy.riborna = data.frame(rna=dmat_unnormed$rna,
ribo=dmat_unnormed$ribo)
xy.ribopro = data.frame(ribo=dmat_unnormed$ribo,
pro=dmat_unnormed$pro)
## Definition of enhanced, attenuated, and null divergence in this document
## RNA-Protein
# Attenuated divergence
ii_rnaGTpro = res.rnapro$int.qval<.01 & ( (abs(xy.rnapro$rna) > abs(xy.rnapro$pro)) | (xy.rnapro$rna * xy.rnapro$pro < 0) )
# Enhanced divegence
ii_proGTrna = res.rnapro$int.qval<.01 & ( (abs(xy.rnapro$pro) > abs(xy.rnapro$rna)) & (xy.rnapro$rna * xy.rnapro$pro > 0 ) )
# Null divergence
ii_proNULLrna = (!(ii_rnaGTpro|ii_proGTrna))
## RNA-Ribo
# Attenuated divergence
ii_rnaGTribo <-
res.riborna$int.qval<.01 & ( (abs(xy.riborna$rna) > abs(xy.riborna$ribo)) | (xy.riborna$rna * xy.riborna$ribo < 0) )
# Enhanced divegence
ii_riboGTrna <-
res.riborna$int.qval<.01 & ( (abs(xy.riborna$ribo) > abs(xy.riborna$rna)) & (xy.riborna$rna * xy.riborna$ribo > 0 ) )
# Null divergence
ii_riboNULLrna <- (!(ii_rnaGTribo|ii_riboGTrna))
a <- ii_rnaGTribo*ii_riboNULLrna_rna_ref
b <- ii_rnaGTribo*ii_rnaNULLribo_rna_ref
table(a,b)
a <- ii_rnaGTribo*ii_riboNULLrna_rna_ref
b <- ii_rnaGTribo*ii_rnaNULLribo_rna_ref
a <- ii_rnaGTribo*ii_riboGTrna_rna_ref
b <- ii_rnaGTribo*ii_rnaGTribo_rna_ref
table(a,b)
a <- ii_riboGTrna_rna_ref[ii_rnaGTribo]
b <- ii_rnaGTribo_rna_ref[ii_rnaGTribo]
table(a,b)
a <- ii_riboGTrna_rna_ref[ii_riboGTrna]
b <- ii_rnaGTribo_rna_ref[ii_riboGTrna]
table(a,b)
sum(ii_rnaGTribo)
a <- ii_riboGTrna_rna_ref[ii_rnaGTribo]
b <- ii_rnaGTribo_rna_ref[ii_rnaGTribo]
table(a,b)
433-324
a <- ii_riboGTrna_rna_ref[ii_riboGTrna]
b <- ii_rnaGTribo_rna_ref[ii_riboGTrna]
table(a,b)
sum( res.riborna$int.qval<.01 & (xy.riborna$rna * xy.riborna$ribo < 0)
& (abs(xy.riborna$ribo) < abs(xy.riborna$rna) ) )
sum( res.riborna$int.qval<.01 & (xy.riborna$rna * xy.riborna$ribo < 0)
& (abs(xy.riborna$ribo) > abs(xy.riborna$rna) ) )
143+181
sum(ii_rnaGTribo_rna_ref[ii_rnaGTribo])
sum(ii_riboGTrna_rna_ref[ii_rnaGTribo])
c <- res.riborna$int.qval<.01 & (xy.riborna$rna * xy.riborna$ribo < 0)
c <- res.riborna$int.qval<.01 & (xy.riborna$rna * xy.riborna$ribo < 0)
d <- ii_riboGTrna_rna_ref*ii_rnaGTribo
table(c,d)
table(c[d])
table(ii_riboGTrna_rna_ref*ii_rnaGTribo)
table(c[which(d)])
table(c[which(d==1)])
c[which(d==1)]
load(file.path(rdadir,"eSetRRP.rda"))
interact2way
eSet <- eSetRRP.RP.Q.log2[ , eSetRRP.RP.Q.log2$species != "rhesus" &
eSetRRP.RP.Q.log2$seqData != "protein"]
res.riborna <- interact2way(eSet)
head(res.riborna)
sum(res.riborna$int.qval < .01)
load(file.path(rdadir,"eSetRRP.rda"))
## eSetRRP.RP.Q.log2 includes standardizd RPKM values
## Human versus Rhesus
eSet_human_rhesus <- eSetRRP.RP.Q.log2[ , eSetRRP.RP.Q.log2$species != "chimp" &
eSetRRP.RP.Q.log2$seqData != "protein"]
res.riborna_human_rhesus <- interact2way(eSet_human_rhesus)
## Chimp versus Rhesus
eSet_chimp_rhesus <- eSetRRP.RP.Q.log2[ , eSetRRP.RP.Q.log2$species != "human" &
eSetRRP.RP.Q.log2$seqData != "protein"]
res.riborna_chimp_rhesus <- interact2way_full_buffer(eSet_chimp_rhesus)
save(res.riborna, file = file.path(rdadir,"TE_other_interspecies.rda"))
sum(res.riborna_human_rhesus$int.qval < .01)
sum(res.riborna_chimp_rhesus$int.qval < .01)
hist(res.riborna$int.pval, freq = FALSE)
temp <- qvalue(res.ribo$int.pval)
temp <- qvalue(res.riborna$int.pval)
temp <- qvalue(res.riborna_human_rhesus$int.pval)
hist(res.riborna_human_rhesus$int.pval, freq = FALSE)
hist(res.rnapro$int.pval, freq = FALSE)
temp <- qvalue(res.riborna$int.pval)
str(a)
str(temp)
temp$lambda
eSet <- eSetRRP.RP.Q.log2[ , eSetRRP.RP.Q.log2$species != "rhesus" &
eSetRRP.RP.Q.log2$seqData != "protein"]
fNames <- featureNames(eSet)
require(nlme)
i = 1
mat1 <- eSet[ featureNames(eSet)==fNames[i], ]
mat1aov.temp <- data.frame( cov=c(t(exprs(mat1))), seqData=mat1$seqData,
species = mat1$species, celline=mat1$celline )
mat1aov.temp$species <- as.factor(mat1aov.temp$species)
mat1aov.temp$seqData <- as.factor(mat1aov.temp$seqData)
fit_null_try <- tryCatch(
fit_null <- gls( cov ~ species + seqData,
weights = varIdent(form=~1|seqData),
data=mat1aov.temp,
na.action = na.omit ),
condition = function(c) c
)
if( inherits( fit_null_try, "condition") ) {
res <- data.frame(LR.pval = NA)
} else {
fit_interact_try <- tryCatch(
fit_interact <- gls( cov ~ species * seqData,
weights = varIdent(form = ~1| seqData),
data = mat1aov.temp,
na.action = na.omit ),
condition = function(c) c
)
if( inherits( fit_interact_try, "condition") ) {
res <- data.frame(LR.pval = NA)
} else {
aov <- anova(fit_null_try, fit_interact_try)
res <- data.frame(LR.pval = aov[2,"p-value"])
}
}
anova(fit_
)
anova(fit_interact_try, fit_null_try)
head(res.riborna)
ls
library(Biobase)
## Set working directories
dir <- "../"
figdir <- file.path(dir,"figures")
rdadir <- file.path(dir,"rdas")
datadir <- file.path(dir, "data")
## Use broman package for colors
require(broman)
crayon <- brocolors("crayons")
## Load customized packages
require(devtools)
require(Humanzee)
## load LRT results of RNA vs. Protein divergence
load(file.path(rdadir,"rnapro.rda"))
## load LRT results of Ribo vs. RNA divergence
load(file.path(rdadir,"TEnew.rda"))
## load LRT results of Ribo vs. RNA divergence
load(file.path(rdadir,"TEnew.rda"))
## Compute fold changes based on un-normalized data
## from the object eSetRRP.log2 in eSetRRP.rda
load(file.path(rdadir,"eSetRRP.rda"))
eSet.temp = eSetRRP.log2[ ,eSetRRP.log2$species!="rhesus"]
fc.mat=lapply(seq_along(c("human","chimp")), function(i) {
ii = eSet.temp$species==c("human","chimp")[i]
eSet.tt = eSet.temp[,ii]
emat = lapply(seq_along(c("ribo","rna","protein")),function(j) {
jj = eSet.tt$seqData==c("ribo","rna","protein")[j]
rowMeans(exprs(eSet.tt[,jj]),na.rm=TRUE)
})
emat=do.call(cbind,emat)
colnames(emat)=c("ribo","rna","protein")
return(data.frame(emat))
})
names(fc.mat)=c("human","chimp")
dmat_unnormed = data.frame(ribo=fc.mat$human$ribo-fc.mat$chimp$ribo,
rna=fc.mat$human$rna-fc.mat$chimp$rna,
pro=fc.mat$human$protein-fc.mat$chimp$protein)
xy.rnapro = data.frame(rna=dmat_unnormed$rna,
pro=dmat_unnormed$pro)
xy.riborna = data.frame(rna=dmat_unnormed$rna,
ribo=dmat_unnormed$ribo)
xy.ribopro = data.frame(ribo=dmat_unnormed$ribo,
pro=dmat_unnormed$pro)
ii_rnaGTpro = res.rnapro$int.qval<.01 & (abs(xy.rnapro$rna) > abs(xy.rnapro$pro))
ii_proGTrna = res.rnapro$int.qval<.01 & (abs(xy.rnapro$pro) > abs(xy.rnapro$rna))
ii_riboGTrna = res.riborna$int.qval<.01 & (abs(xy.riborna$ribo) > abs(xy.riborna$rna))
ii_rnaGTribo = res.riborna$int.qval<.01 & (abs(xy.riborna$ribo) < abs(xy.riborna$rna))
sum(ii_riboGTrna*ii_proGTrna)
sum(ii_rnaGTribo*ii_rnaGTpro)
sum(ii_rnaGTribo)
sum(ii_riboGTrna)
57/290
22/188
ii_riboGTrna <-
res.riborna$int.qval<.01 & (  (xy.riborna$rna * xy.riborna$ribo > 0 ) )
sum(ii_riboGTrna)
290-154
ii_riboGTrna <-
res.riborna$int.qval<.01 & ( (abs(xy.riborna$ribo) > abs(xy.riborna$rna))  )
sum(ii_riboGTrna)
190-109
load(file.path(rdadir, "TEnew.rda"))
# load LRT results
load(file.path(rdadir, "TEnew.rda"))
# Attenuated divergence
ii_rnaGTribo <-
res.riborna$int.qval<.01 & ( (abs(xy.riborna$rna) > abs(xy.riborna$ribo)) | (xy.riborna$rna * xy.riborna$ribo < 0) )
# Enhanced divegence
ii_riboGTrna <-
res.riborna$int.qval<.01 & ( (abs(xy.riborna$ribo) > abs(xy.riborna$rna)) & (xy.riborna$rna * xy.riborna$ribo > 0 ) )
# Attenuated divergence
ii_rnaGTribo_0 <-
res.riborna$int.qval<.01 & (abs(xy.riborna$rna) > abs(xy.riborna$ribo)
# Enhanced divegence
ii_riboGTrna_0 <-
res.riborna$int.qval<.01 & (abs(xy.riborna$ribo) > abs(xy.riborna$rna)
# Attenuated divergence
ii_rnaGTribo_0 <-
res.riborna$int.qval<.01 & (abs(xy.riborna$rna) > abs(xy.riborna$ribo)
# Attenuated divergence
ii_rnaGTribo_0 <-
res.riborna$int.qval<.01 & (abs(xy.riborna$rna) > abs(xy.riborna$ribo) )
load(file.path(rdadir, "TEnew.rda"))
# Attenuated divergence
ii_rnaGTribo_0 <-
res.riborna$int.qval<.01 & (abs(xy.riborna$rna) > abs(xy.riborna$ribo) )
# Enhanced divegence
ii_riboGTrna_0 <-
res.riborna$int.qval<.01 & (abs(xy.riborna$ribo) > abs(xy.riborna$rna) )
# Attenuated divergence
ii_rnaGTribo_0 <-
res.riborna$int.qval<.01 & (abs(xy.riborna$rna) > abs(xy.riborna$ribo) )
table(ii_rnaGTribo_0, ii_rnaGTribo)
table(ii_riboGTrna_0, ii_riboGTrna)
table(ii_rnaGTribo_0*(res.riborna$int.qval < .01),
ii_rnaGTribo*(res.riborna$int.qval < .01))
table(ii_riboGTrna_0*(res.riborna$int.qval < .01),
ii_riboGTrna*(res.riborna$int.qval < .01))
table(ii_rnaGTribo_0[res.riborna$int.qval < .01],
ii_rnaGTribo[res.riborna$int.qval < .01] )
table(ii_riboGTrna_0[res.riborna$int.qval < .01],
ii_riboGTrna[res.riborna$int.qval < .01])
109+181
sum(ii_rnaGTribo_0[res.riborna$int.qval < .01])
sum(ii_rnaGTribo[res.riborna$int.qval < .01])
sum(ii_riboGTrna_0[res.riborna$int.qval < .01])
sum(ii_riboGTrna[res.riborna$int.qval < .01])
sum(ii_riboGTrna_0)
sum(ii_rnaGTribo_0)
sum(ii_rnaGTribo_0)
sum(ii_riboGTrna_0)
res.riborna$int.qval<.01 & ( (abs(xy.riborna$rna) > abs(xy.riborna$ribo))
sum(res.riborna$int.qval<.01 &  (abs(xy.riborna$rna) > abs(xy.riborna$ribo) ) )
sum(res.riborna$int.qval<.01 &  (abs(xy.riborna$rna) > abs(xy.riborna$ribo) ) )
ii_rnaGTribo <- sum(res.riborna$int.qval<.01 &  (abs(xy.riborna$rna) > abs(xy.riborna$ribo) | (xy.riborna$rna * xy.riborna$ribo < 0) ) )
sum(res.riborna$int.qval<.01 &  (abs(xy.riborna$rna) > abs(xy.riborna$ribo) ) )
sum(res.riborna$int.qval<.01 &  (abs(xy.riborna$rna) > abs(xy.riborna$ribo) | (xy.riborna$rna * xy.riborna$ribo < 0) ) )
369-188
rm(list=ls())
library(Biobase)
## Set working directories
dir <- "../"
figdir <- file.path(dir,"figures")
rdadir <- file.path(dir,"rdas")
datadir <- file.path(dir, "data")
## Use broman package for colors
require(broman)
crayon <- brocolors("crayons")
## Load customized packages
require(devtools)
require(Humanzee)
load(file.path(rdadir,"eSetRRP.rda"))
eSet_chimp_rhesus <- eSetRRP.RP.Q.log2[ , eSetRRP.RP.Q.log2$species != "human" &
eSetRRP.RP.Q.log2$seqData != "protein"]
res.riborna_chimp_rhesus <- interact2way_full_buffer(eSet_chimp_rhesus)
sum(res.riborna_chimp_rhesus$int.qval<.01)
boxplot(exprs(eSetRRP.RP.Q.log2))
boxplot(exprs(eSet_chimp_rhesus))
boxplot(exprs(eSetRRP.RP.Q.log2[,eSetRRP.RP.Q.log2$seqData ! = "protein"]))
boxplot(exprs(eSetRRP.RP.Q.log2[,eSetRRP.RP.Q.log2$seqData != "protein"]))
str(exprs(eSet_chimp_rhesus))
summary(pData(eSet_chimp_rhesus))
summary(phenoData(eSet_chimp_rhesus))
summary(exprs(eSet_chimp_rhessu))
summary(exprs(eSet_chimp_rhesus))
summary(res.ribo_chimp_rhesus$int.qval)
summary(res.riborna_chimp_rhesus$int.qval)
table(res.riboran_chimp_rhesus$int.pval)
table(res.riborna_chimp_rhesus$int.pval)
hist(res.riborna_chimp_rhesus$int.pval)
eSet_human_rhesus <- eSetRRP.RP.Q.log2[ , eSetRRP.RP.Q.log2$species != "chimp" &
eSetRRP.RP.Q.log2$seqData != "protein"]
res.riborna_human_rhesus <- interact2way(eSet_human_rhesus)
load(file.path(rdadir, "DE.rda"))
ls()
load(file.path(rdadir, "DE.rda"))
head(riboRes)
boxplot(exprs(eSetRRP.log2))
phenoData(eSetRRP.log2)
pData(eSetRRP.log2)
sum(riboRes.Q$qval < .01)
sum(rnaRes.Q$qval < .01)
riboRes.Q_human_rheus <-
testDE(eSetRRP.Q.log2,
seqData="ribo",species=c("human","rhesus"))$res
rnaRes.Q_human_rheus <-
testDE(eSetRRP.Q.log2,
seqData = "rna",species=c("human","rhesus"))$res
riboRes.Q_human_rheus <-
testDE(eSetRRP.Q.log2,
seqData = "ribo",species=c("human","rhesus"))$res
rnaRes.Q_human_rheus <-
testDE(eSetRRP.Q.log2,
seqData = "rna",species=c("human","rhesus"))$res
load(file.path(rdadir, "DE.rda"))
riboRes.Q_human_rheus <-
testDE(eSetRRP.Q.log2,
seqData = "ribo",species=c("human","rhesus"))$res
rnaRes.Q = testDE(eSetRRP.Q.log2,seqData="rna",species=c("human","chimp"))$res
rnaRes = testDE(eSetRRP.log2,seqData="rna",species=c("human","chimp"))$res
exprs(eSetRRP.Q.log2)
boxplot(exprs(eSetRRP.Q.log2))
boxplot(exprs(eSetRRP.Q.log2)[,eSetRRP.Q.log2$seqData =="rna"])
boxplot(exprs(eSetRRP.log2)[,eSetRRP.Q.log2$seqData =="rna"])
testDE
ribo.Res.hc = testDE(eSet.ribo.rpkmq,seqData="ribo",species=c("human","chimp"))$res
ribo.Res.hc = testDE(eSet.ribo.rpkmq,seqData="ribo",species=c("human","chimp"))$res
load(file.path(rdadir, "eSetRiboProfile.rda"))
ribo.Res.hc = testDE(eSet.ribo.rpkmq,seqData="ribo",species=c("human","chimp"))$res
ribo.Res.hc = testDE(eSet.ribo.rpkmq,seqData="ribo",species=c("human","chimp"))
install_github("jhsiao999/Humanzee")
ribo.Res.hc = testDE(eSet.ribo.rpkmq,seqData="ribo",species=c("human","chimp"))$res
head(ribo.Res.hc)
sum(ribo.Res.hc$qval<.01)
testDE(eSetRRP.Q.log2,seqData="rna",species=c("human","chimp"))$res
riboRes.Q_sub_cr <-
testDE(eSetRRP.Q.log2,seqData="rna",species=c("chimp","rhesus"))$res
rnaRes.Q_sub_cr <-
testDE(eSetRRP.Q.log2,seqData="rna",species=c("chimp","rhesus"))$res
riboRes.Q_sub_hr <-
testDE(eSetRRP.Q.log2,seqData="rna",species=c("human","rhesus"))$res
rnaRes.Q_sub_hr <-
testDE(eSetRRP.Q.log2,seqData="rna",species=c("human","rhesus"))$res
sum(riboRes.Q_sub_cr$qval<.01)
sum(rnaRes.Q_sub_cr$qval<.01)
riboRes.Q_sub_cr <-
testDE(eSetRRP.Q.log2,seqData="ribo",species=c("chimp","rhesus"))$res
rnaRes.Q_sub_cr <-
testDE(eSetRRP.Q.log2,seqData="rna",species=c("chimp","rhesus"))$res
riboRes.Q_sub_hr <-
testDE(eSetRRP.Q.log2,seqData="ribo",species=c("human","rhesus"))$res
rnaRes.Q_sub_hr <-
testDE(eSetRRP.Q.log2,seqData="rna",species=c("human","rhesus"))$res
sum(riboRes.Q_sub_cr$qval<.01)
sum(rnaRes.Q_sub_cr$qval<.01)
sum(riboRes.Q_sub_hr$qval<.01)
sum(rnaRes.Q_sub_hr$qval<.01)
sum(riboRes.Q$qval<.01)
sum(rnaRes.Q$qval<.01)
sum(res.riborna$int.qval <.01)
sum(rnaRes.Q_sub_hr$qval<.01)
sum(riboRes.Q_sub_hr$qval<.01)
sum(rnaRes.Q$qval<.01)
sum(riboRes.Q$qval<.01)
load(file.path(rdadir, "TEnew.rda"))
sum(res.riborna$int.qval <.01)
sum(res.riborna_human_rhesus$int.qval <.01)
sum(rnaRes.Q_sub_cr$qval<.01)
sum(riboRes.Q_sub_cr$qval<.01)
sum(res.riborna_chimp_rhesus$int.qval < .01)
sum(rnaRes.Q_sub_cr$qval<.01 & riboRes.Q_sub$qval < .01)
sum(rnaRes.Q_sub_cr$qval<.01 & riboRes.Q_sub_cr$qval < .01)
sum(rnaRes.Q_sub_hr$qval<.01 & riboRes.Q_sub_hr$qval < .01)
sum(rnaRes.Q$qva<.01 & riboRes.Q$qval < .01)
